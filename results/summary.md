# Benchmark Results Summary

## Complete Results

| model_size   |   d_model |   context_length |   num_layers |   num_heads |   batch_size |   num_warmups |   num_trials | forward_only   |   mean_time_ms |   std_time_ms |
|:-------------|----------:|-----------------:|-------------:|------------:|-------------:|--------------:|-------------:|:---------------|---------------:|--------------:|
| small        |       768 |              128 |           12 |          12 |            4 |             0 |           10 | False          |         192.65 |        258.17 |
| small        |       768 |              128 |           12 |          12 |            4 |             0 |           10 | True           |         105.1  |        209.74 |
| small        |       768 |              128 |           12 |          12 |            4 |             1 |           10 | False          |         110.85 |          2.15 |
| small        |       768 |              128 |           12 |          12 |            4 |             1 |           10 | True           |          38    |          2.06 |
| small        |       768 |              128 |           12 |          12 |            4 |             5 |           10 | False          |         109.76 |          7.26 |
| small        |       768 |              128 |           12 |          12 |            4 |             5 |           10 | True           |          37.73 |          1.86 |
| small        |       768 |              256 |           12 |          12 |            4 |             0 |           10 | False          |         200.16 |        274.2  |
| small        |       768 |              256 |           12 |          12 |            4 |             0 |           10 | True           |         106.96 |        222.22 |
| small        |       768 |              256 |           12 |          12 |            4 |             1 |           10 | False          |         111.17 |          3.07 |
| small        |       768 |              256 |           12 |          12 |            4 |             1 |           10 | True           |          37.45 |          0.41 |
| small        |       768 |              256 |           12 |          12 |            4 |             5 |           10 | False          |         112.58 |          2.85 |
| small        |       768 |              256 |           12 |          12 |            4 |             5 |           10 | True           |          39.43 |          2.81 |
| medium       |      1024 |              128 |           24 |          16 |            4 |             0 |           10 | False          |         262.27 |        231.36 |
| medium       |      1024 |              128 |           24 |          16 |            4 |             0 |           10 | True           |         138.87 |        202.04 |
| medium       |      1024 |              128 |           24 |          16 |            4 |             1 |           10 | False          |         189.66 |          2.07 |
| medium       |      1024 |              128 |           24 |          16 |            4 |             1 |           10 | True           |          72.55 |          0.75 |
| medium       |      1024 |              128 |           24 |          16 |            4 |             5 |           10 | False          |         190.47 |          7.66 |
| medium       |      1024 |              128 |           24 |          16 |            4 |             5 |           10 | True           |          73.7  |          0.85 |
| medium       |      1024 |              256 |           24 |          16 |            4 |             0 |           10 | False          |         274.25 |        260.39 |
| medium       |      1024 |              256 |           24 |          16 |            4 |             0 |           10 | True           |         138.91 |        202.53 |
| medium       |      1024 |              256 |           24 |          16 |            4 |             1 |           10 | False          |         187.22 |          1.84 |
| medium       |      1024 |              256 |           24 |          16 |            4 |             1 |           10 | True           |          74.11 |          0.54 |
| medium       |      1024 |              256 |           24 |          16 |            4 |             5 |           10 | False          |         187.12 |          1.05 |
| medium       |      1024 |              256 |           24 |          16 |            4 |             5 |           10 | True           |          73.74 |          0.22 |
| large        |      1280 |              128 |           36 |          20 |            4 |             0 |           10 | False          |         352.39 |        261.88 |
| large        |      1280 |              128 |           36 |          20 |            4 |             0 |           10 | True           |         185.95 |        236.58 |
| large        |      1280 |              128 |           36 |          20 |            4 |             1 |           10 | False          |         260.29 |          2.72 |
| large        |      1280 |              128 |           36 |          20 |            4 |             1 |           10 | True           |         109.56 |          0.37 |
| large        |      1280 |              128 |           36 |          20 |            4 |             5 |           10 | False          |         257.07 |          2.5  |
| large        |      1280 |              128 |           36 |          20 |            4 |             5 |           10 | True           |          93.84 |         17.9  |
| large        |      1280 |              256 |           36 |          20 |            4 |             0 |           10 | False          |         381.02 |        282.06 |
| large        |      1280 |              256 |           36 |          20 |            4 |             0 |           10 | True           |         194.47 |        252.74 |
| large        |      1280 |              256 |           36 |          20 |            4 |             1 |           10 | False          |         294.13 |          3.71 |
| large        |      1280 |              256 |           36 |          20 |            4 |             1 |           10 | True           |         111.82 |          0.62 |
| large        |      1280 |              256 |           36 |          20 |            4 |             5 |           10 | False          |         296.62 |          2.91 |
| large        |      1280 |              256 |           36 |          20 |            4 |             5 |           10 | True           |         110.27 |          0.97 |
| xl           |      1600 |              128 |           48 |          25 |            4 |             0 |           10 | False          |         436.71 |        271.4  |
| xl           |      1600 |              128 |           48 |          25 |            4 |             0 |           10 | True           |         216.44 |        221.61 |
| xl           |      1600 |              128 |           48 |          25 |            4 |             1 |           10 | False          |         352.56 |         18.98 |
| xl           |      1600 |              128 |           48 |          25 |            4 |             1 |           10 | True           |         154    |          1.87 |
| xl           |      1600 |              128 |           48 |          25 |            4 |             5 |           10 | False          |         348.37 |         14.33 |
| xl           |      1600 |              128 |           48 |          25 |            4 |             5 |           10 | True           |         151.31 |          2.36 |
| xl           |      1600 |              256 |           48 |          25 |            4 |             0 |           10 | False          |         592.18 |        302.4  |
| xl           |      1600 |              256 |           48 |          25 |            4 |             0 |           10 | True           |         240.21 |        254.99 |
| xl           |      1600 |              256 |           48 |          25 |            4 |             1 |           10 | False          |         496.57 |          8.41 |
| xl           |      1600 |              256 |           48 |          25 |            4 |             1 |           10 | True           |         162.24 |          9.25 |
| xl           |      1600 |              256 |           48 |          25 |            4 |             5 |           10 | False          |         499.76 |          8.49 |
| xl           |      1600 |              256 |           48 |          25 |            4 |             5 |           10 | True           |         163.1  |          5.15 |
| 2.7B         |      2560 |              128 |           32 |          32 |            4 |             0 |           10 | False          |         494.75 |        284.29 |
| 2.7B         |      2560 |              128 |           32 |          32 |            4 |             0 |           10 | True           |         171.98 |        131.46 |
| 2.7B         |      2560 |              128 |           32 |          32 |            4 |             1 |           10 | False          |         404.5  |          6.62 |
| 2.7B         |      2560 |              128 |           32 |          32 |            4 |             1 |           10 | True           |         131.32 |          5.2  |
| 2.7B         |      2560 |              128 |           32 |          32 |            4 |             5 |           10 | False          |         405.91 |          4.48 |
| 2.7B         |      2560 |              128 |           32 |          32 |            4 |             5 |           10 | True           |         133.29 |          4.27 |
| 2.7B         |      2560 |              256 |           32 |          32 |            4 |             0 |           10 | False          |         823.07 |        221.69 |
| 2.7B         |      2560 |              256 |           32 |          32 |            4 |             0 |           10 | True           |         303.07 |        184.7  |
| 2.7B         |      2560 |              256 |           32 |          32 |            4 |             1 |           10 | False          |         753.9  |          9.7  |
| 2.7B         |      2560 |              256 |           32 |          32 |            4 |             1 |           10 | True           |         244.55 |          7.62 |
| 2.7B         |      2560 |              256 |           32 |          32 |            4 |             5 |           10 | False          |         756.93 |          2.7  |
| 2.7B         |      2560 |              256 |           32 |          32 |            4 |             5 |           10 | True           |         246.86 |          5.7  |

## Results by Model Size

### Model: small

|   context_length |   num_warmups | forward_only   |   mean_time_ms |   std_time_ms |
|-----------------:|--------------:|:---------------|---------------:|--------------:|
|              128 |             0 | False          |         192.65 |        258.17 |
|              128 |             0 | True           |         105.1  |        209.74 |
|              128 |             1 | False          |         110.85 |          2.15 |
|              128 |             1 | True           |          38    |          2.06 |
|              128 |             5 | False          |         109.76 |          7.26 |
|              128 |             5 | True           |          37.73 |          1.86 |
|              256 |             0 | False          |         200.16 |        274.2  |
|              256 |             0 | True           |         106.96 |        222.22 |
|              256 |             1 | False          |         111.17 |          3.07 |
|              256 |             1 | True           |          37.45 |          0.41 |
|              256 |             5 | False          |         112.58 |          2.85 |
|              256 |             5 | True           |          39.43 |          2.81 |

### Model: medium

|   context_length |   num_warmups | forward_only   |   mean_time_ms |   std_time_ms |
|-----------------:|--------------:|:---------------|---------------:|--------------:|
|              128 |             0 | False          |         262.27 |        231.36 |
|              128 |             0 | True           |         138.87 |        202.04 |
|              128 |             1 | False          |         189.66 |          2.07 |
|              128 |             1 | True           |          72.55 |          0.75 |
|              128 |             5 | False          |         190.47 |          7.66 |
|              128 |             5 | True           |          73.7  |          0.85 |
|              256 |             0 | False          |         274.25 |        260.39 |
|              256 |             0 | True           |         138.91 |        202.53 |
|              256 |             1 | False          |         187.22 |          1.84 |
|              256 |             1 | True           |          74.11 |          0.54 |
|              256 |             5 | False          |         187.12 |          1.05 |
|              256 |             5 | True           |          73.74 |          0.22 |

### Model: large

|   context_length |   num_warmups | forward_only   |   mean_time_ms |   std_time_ms |
|-----------------:|--------------:|:---------------|---------------:|--------------:|
|              128 |             0 | False          |         352.39 |        261.88 |
|              128 |             0 | True           |         185.95 |        236.58 |
|              128 |             1 | False          |         260.29 |          2.72 |
|              128 |             1 | True           |         109.56 |          0.37 |
|              128 |             5 | False          |         257.07 |          2.5  |
|              128 |             5 | True           |          93.84 |         17.9  |
|              256 |             0 | False          |         381.02 |        282.06 |
|              256 |             0 | True           |         194.47 |        252.74 |
|              256 |             1 | False          |         294.13 |          3.71 |
|              256 |             1 | True           |         111.82 |          0.62 |
|              256 |             5 | False          |         296.62 |          2.91 |
|              256 |             5 | True           |         110.27 |          0.97 |

### Model: xl

|   context_length |   num_warmups | forward_only   |   mean_time_ms |   std_time_ms |
|-----------------:|--------------:|:---------------|---------------:|--------------:|
|              128 |             0 | False          |         436.71 |        271.4  |
|              128 |             0 | True           |         216.44 |        221.61 |
|              128 |             1 | False          |         352.56 |         18.98 |
|              128 |             1 | True           |         154    |          1.87 |
|              128 |             5 | False          |         348.37 |         14.33 |
|              128 |             5 | True           |         151.31 |          2.36 |
|              256 |             0 | False          |         592.18 |        302.4  |
|              256 |             0 | True           |         240.21 |        254.99 |
|              256 |             1 | False          |         496.57 |          8.41 |
|              256 |             1 | True           |         162.24 |          9.25 |
|              256 |             5 | False          |         499.76 |          8.49 |
|              256 |             5 | True           |         163.1  |          5.15 |

### Model: 2.7B

|   context_length |   num_warmups | forward_only   |   mean_time_ms |   std_time_ms |
|-----------------:|--------------:|:---------------|---------------:|--------------:|
|              128 |             0 | False          |         494.75 |        284.29 |
|              128 |             0 | True           |         171.98 |        131.46 |
|              128 |             1 | False          |         404.5  |          6.62 |
|              128 |             1 | True           |         131.32 |          5.2  |
|              128 |             5 | False          |         405.91 |          4.48 |
|              128 |             5 | True           |         133.29 |          4.27 |
|              256 |             0 | False          |         823.07 |        221.69 |
|              256 |             0 | True           |         303.07 |        184.7  |
|              256 |             1 | False          |         753.9  |          9.7  |
|              256 |             1 | True           |         244.55 |          7.62 |
|              256 |             5 | False          |         756.93 |          2.7  |
|              256 |             5 | True           |         246.86 |          5.7  |

## Forward-Only vs Forward+Backward Comparison

| model_size   |   context_length |   num_warmups | forward_only   |   mean_time_ms |   std_time_ms |
|:-------------|-----------------:|--------------:|:---------------|---------------:|--------------:|
| small        |              128 |             0 | False          |         192.65 |        258.17 |
| small        |              128 |             0 | True           |         105.1  |        209.74 |
| small        |              128 |             1 | False          |         110.85 |          2.15 |
| small        |              128 |             1 | True           |          38    |          2.06 |
| small        |              128 |             5 | False          |         109.76 |          7.26 |
| small        |              128 |             5 | True           |          37.73 |          1.86 |
| small        |              256 |             0 | False          |         200.16 |        274.2  |
| small        |              256 |             0 | True           |         106.96 |        222.22 |
| small        |              256 |             1 | False          |         111.17 |          3.07 |
| small        |              256 |             1 | True           |          37.45 |          0.41 |
| small        |              256 |             5 | False          |         112.58 |          2.85 |
| small        |              256 |             5 | True           |          39.43 |          2.81 |
| medium       |              128 |             0 | False          |         262.27 |        231.36 |
| medium       |              128 |             0 | True           |         138.87 |        202.04 |
| medium       |              128 |             1 | False          |         189.66 |          2.07 |
| medium       |              128 |             1 | True           |          72.55 |          0.75 |
| medium       |              128 |             5 | False          |         190.47 |          7.66 |
| medium       |              128 |             5 | True           |          73.7  |          0.85 |
| medium       |              256 |             0 | False          |         274.25 |        260.39 |
| medium       |              256 |             0 | True           |         138.91 |        202.53 |
| medium       |              256 |             1 | False          |         187.22 |          1.84 |
| medium       |              256 |             1 | True           |          74.11 |          0.54 |
| medium       |              256 |             5 | False          |         187.12 |          1.05 |
| medium       |              256 |             5 | True           |          73.74 |          0.22 |
| large        |              128 |             0 | False          |         352.39 |        261.88 |
| large        |              128 |             0 | True           |         185.95 |        236.58 |
| large        |              128 |             1 | False          |         260.29 |          2.72 |
| large        |              128 |             1 | True           |         109.56 |          0.37 |
| large        |              128 |             5 | False          |         257.07 |          2.5  |
| large        |              128 |             5 | True           |          93.84 |         17.9  |
| large        |              256 |             0 | False          |         381.02 |        282.06 |
| large        |              256 |             0 | True           |         194.47 |        252.74 |
| large        |              256 |             1 | False          |         294.13 |          3.71 |
| large        |              256 |             1 | True           |         111.82 |          0.62 |
| large        |              256 |             5 | False          |         296.62 |          2.91 |
| large        |              256 |             5 | True           |         110.27 |          0.97 |
| xl           |              128 |             0 | False          |         436.71 |        271.4  |
| xl           |              128 |             0 | True           |         216.44 |        221.61 |
| xl           |              128 |             1 | False          |         352.56 |         18.98 |
| xl           |              128 |             1 | True           |         154    |          1.87 |
| xl           |              128 |             5 | False          |         348.37 |         14.33 |
| xl           |              128 |             5 | True           |         151.31 |          2.36 |
| xl           |              256 |             0 | False          |         592.18 |        302.4  |
| xl           |              256 |             0 | True           |         240.21 |        254.99 |
| xl           |              256 |             1 | False          |         496.57 |          8.41 |
| xl           |              256 |             1 | True           |         162.24 |          9.25 |
| xl           |              256 |             5 | False          |         499.76 |          8.49 |
| xl           |              256 |             5 | True           |         163.1  |          5.15 |
| 2.7B         |              128 |             0 | False          |         494.75 |        284.29 |
| 2.7B         |              128 |             0 | True           |         171.98 |        131.46 |
| 2.7B         |              128 |             1 | False          |         404.5  |          6.62 |
| 2.7B         |              128 |             1 | True           |         131.32 |          5.2  |
| 2.7B         |              128 |             5 | False          |         405.91 |          4.48 |
| 2.7B         |              128 |             5 | True           |         133.29 |          4.27 |
| 2.7B         |              256 |             0 | False          |         823.07 |        221.69 |
| 2.7B         |              256 |             0 | True           |         303.07 |        184.7  |
| 2.7B         |              256 |             1 | False          |         753.9  |          9.7  |
| 2.7B         |              256 |             1 | True           |         244.55 |          7.62 |
| 2.7B         |              256 |             5 | False          |         756.93 |          2.7  |
| 2.7B         |              256 |             5 | True           |         246.86 |          5.7  |

## Effect of Number of Warmup Runs

| model_size   |   context_length |   num_warmups |   mean_time_ms |   std_time_ms |
|:-------------|-----------------:|--------------:|---------------:|--------------:|
| 2.7B         |              128 |             0 |         494.75 |        284.29 |
| 2.7B         |              128 |             0 |         171.98 |        131.46 |
| 2.7B         |              128 |             1 |         404.5  |          6.62 |
| 2.7B         |              128 |             1 |         131.32 |          5.2  |
| 2.7B         |              128 |             5 |         405.91 |          4.48 |
| 2.7B         |              128 |             5 |         133.29 |          4.27 |
| 2.7B         |              256 |             0 |         823.07 |        221.69 |
| 2.7B         |              256 |             0 |         303.07 |        184.7  |
| 2.7B         |              256 |             1 |         753.9  |          9.7  |
| 2.7B         |              256 |             1 |         244.55 |          7.62 |
| 2.7B         |              256 |             5 |         756.93 |          2.7  |
| 2.7B         |              256 |             5 |         246.86 |          5.7  |
| large        |              128 |             0 |         352.39 |        261.88 |
| large        |              128 |             0 |         185.95 |        236.58 |
| large        |              128 |             1 |         260.29 |          2.72 |
| large        |              128 |             1 |         109.56 |          0.37 |
| large        |              128 |             5 |         257.07 |          2.5  |
| large        |              128 |             5 |          93.84 |         17.9  |
| large        |              256 |             0 |         381.02 |        282.06 |
| large        |              256 |             0 |         194.47 |        252.74 |
| large        |              256 |             1 |         294.13 |          3.71 |
| large        |              256 |             1 |         111.82 |          0.62 |
| large        |              256 |             5 |         296.62 |          2.91 |
| large        |              256 |             5 |         110.27 |          0.97 |
| medium       |              128 |             0 |         262.27 |        231.36 |
| medium       |              128 |             0 |         138.87 |        202.04 |
| medium       |              128 |             1 |         189.66 |          2.07 |
| medium       |              128 |             1 |          72.55 |          0.75 |
| medium       |              128 |             5 |         190.47 |          7.66 |
| medium       |              128 |             5 |          73.7  |          0.85 |
| medium       |              256 |             0 |         274.25 |        260.39 |
| medium       |              256 |             0 |         138.91 |        202.53 |
| medium       |              256 |             1 |         187.22 |          1.84 |
| medium       |              256 |             1 |          74.11 |          0.54 |
| medium       |              256 |             5 |         187.12 |          1.05 |
| medium       |              256 |             5 |          73.74 |          0.22 |
| small        |              128 |             0 |         192.65 |        258.17 |
| small        |              128 |             0 |         105.1  |        209.74 |
| small        |              128 |             1 |         110.85 |          2.15 |
| small        |              128 |             1 |          38    |          2.06 |
| small        |              128 |             5 |         109.76 |          7.26 |
| small        |              128 |             5 |          37.73 |          1.86 |
| small        |              256 |             0 |         200.16 |        274.2  |
| small        |              256 |             0 |         106.96 |        222.22 |
| small        |              256 |             1 |         111.17 |          3.07 |
| small        |              256 |             1 |          37.45 |          0.41 |
| small        |              256 |             5 |         112.58 |          2.85 |
| small        |              256 |             5 |          39.43 |          2.81 |
| xl           |              128 |             0 |         436.71 |        271.4  |
| xl           |              128 |             0 |         216.44 |        221.61 |
| xl           |              128 |             1 |         352.56 |         18.98 |
| xl           |              128 |             1 |         154    |          1.87 |
| xl           |              128 |             5 |         348.37 |         14.33 |
| xl           |              128 |             5 |         151.31 |          2.36 |
| xl           |              256 |             0 |         592.18 |        302.4  |
| xl           |              256 |             0 |         240.21 |        254.99 |
| xl           |              256 |             1 |         496.57 |          8.41 |
| xl           |              256 |             1 |         162.24 |          9.25 |
| xl           |              256 |             5 |         499.76 |          8.49 |
| xl           |              256 |             5 |         163.1  |          5.15 |

### Mean Time by Warmup Count

| model_size   |      0 |      1 |      5 |
|:-------------|-------:|-------:|-------:|
| 2.7B         | 448.22 | 383.57 | 385.75 |
| large        | 278.46 | 193.95 | 189.45 |
| medium       | 203.58 | 130.89 | 131.26 |
| small        | 151.22 |  74.37 |  74.87 |
| xl           | 371.39 | 291.34 | 290.63 |

## Summary Statistics

|       |   mean_time_ms |   std_time_ms |
|:------|---------------:|--------------:|
| count |          60    |         60    |
| mean  |         239.93 |         82.51 |
| std   |         179.43 |        113.51 |
| min   |          37.45 |          0.22 |
| 25%   |         111.09 |          2.31 |
| 50%   |         188.44 |          6.94 |
| 75%   |         298.23 |        212.71 |
| max   |         823.07 |        302.4  |
